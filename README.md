# STM32F446_Lock_in_V01
Implementation of a digital lock-in amplifier using a STM32F446RE Nucleo Board

This Tutorial describes the steps of develop of a digital lock-in amplifier.
Firstly, i´am going to care with the processing of the signal (Version 01). After, in a second moment, i am going to improve the quality of the signal using stages of pre-amplifier and filters.

The figure below illustrates the basic operation of a lock-in amplifier.
![Lock-in Processing img](https://user-images.githubusercontent.com/114233216/228120262-0e5bbd8e-1b59-4e33-bd7d-913f8ae0ed24.png)

In summary, the signals Vs and Vr are multiplied in phase and in quadrature (i.e. with Vr shifted by 90°), are filtered, and finally undergo vector multiplication. 
The entire mathematical operation is described in detail in this file:
[Lock-in Processing.pdf](https://github.com/BernardoLima92/STM32F446_Lock_in_V01/files/11084935/Lock-in.Processing.pdf).

In practical terms, the signal Vs is the signal that we are actually interested in measuring, and it originates from some experiment. The reference signal is a signal generated by an oscillator, either externally or internally.

When the reference signal is generated externally, by a bench function generator for example, the lock-in amplifier must be able to acquire (read in its analog port) the Vs and Vr signals synchronously.  This requires on the lock-in side the use of some circuitry called PLL (Phased Lock Loop). 

On the other hand, when the reference signal is generated internally, the lock-in amplifier only needs to acquire (read in its analog port) the Vs signal, because the reference signal is already stored in the lock-in's own memory. In this way it is much easier to synchronize the signals and to shift the reference signal with great precision.

This tutorial is based on the internally generated reference signal in the STM32 microcontroller itself.

So, in summary, what the lock-in developed in this work does is shown in this figure below:
